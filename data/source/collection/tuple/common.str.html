<code id="0"><span style="color: rgb(63, 127, 95)">/**</span></code>
<code id="1"><span style="color: rgb(63, 127, 95)"> * This module contains strategies for operating on tuples.</span></code>
<code id="2"><span style="color: rgb(63, 127, 95)"> *</span></code>
<code id="3"><span style="color: rgb(63, 127, 95)"> * In Stratego, tuples are a terms, separate from lists. </span></code>
<code id="4"><span style="color: rgb(63, 127, 95)"> *</span></code>
<code id="5"><span style="color: rgb(63, 127, 95)"> * @author Eelco Visser &lt;visser@acm.org&gt;</span></code>
<code id="6"><span style="color: rgb(63, 127, 95)"> * @author Karl Trygve Kalleberg &lt;karltk@strategoxt.org&gt; - documentation</span></code>
<code id="7"><span style="color: rgb(63, 127, 95)"> *</span></code>
<code id="8"><span style="color: rgb(63, 127, 95)"> * @see collection/list/common</span></code>
<code id="9"><span style="color: rgb(63, 127, 95)"> */</code>
<code id="10"></span><span style="color: rgb(127, 0, 85)">module</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">collection/tuple/common</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="11"></span><span style="color: rgb(127, 0, 85)">imports</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="12"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">collection/list/cons</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="13"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">collection/tuple/cons</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="14"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">collection/list/index</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="15"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">collection/list/zip</span></code>
<code id="16"><span style="color: rgb(127, 0, 85)">strategies</span></code>
<code id="17"></code>
<code id="18"><span style="color: rgb(63, 127, 95)">  /** Convert a tuple to a list.</span></code>
<code id="19"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="20"><span style="color: rgb(63, 127, 95)">   * @type List(a) -&gt; Tuple(a)</span></code>
<code id="21"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="22"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">TupleToList</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span></code>
<code id="23"><span style="color: rgb(63, 127, 95)">  </span></code>
<code id="24"><span style="color: rgb(63, 127, 95)">  /** Convert a list to a tuple.</span></code>
<code id="25"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="26"><span style="color: rgb(63, 127, 95)">   * @type Tuple(a) -&gt; List(a)</span></code>
<code id="27"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="28"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">ListToTuple</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="29"></code>
<code id="30"><span style="color: rgb(63, 127, 95)">  /** Retrieve the first element of a tuple.</span></code>
<code id="31"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="32"><span style="color: rgb(63, 127, 95)">   * @type Tuple(a, xs...) -&gt; a</span></code>
<code id="33"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="34"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Fst</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span></code>
<code id="35"><span style="color: rgb(63, 127, 95)">  </span></code>
<code id="36"><span style="color: rgb(63, 127, 95)">  /** Retrieve the second element of a tuple.</span></code>
<code id="37"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="38"><span style="color: rgb(63, 127, 95)">   * @type Tuple(a, b, xs...) -&gt; b</span></code>
<code id="39"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="40"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Snd</span><span style="color: rgb(0, 64, 128)">   </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span></code>
<code id="41"></code>
<code id="42"><span style="color: rgb(63, 127, 95)">  /** Retrieve the third element of a tuple.</span></code>
<code id="43"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="44"><span style="color: rgb(63, 127, 95)">   * @type Tuple(a, b, c, xs...) -&gt; c</span></code>
<code id="45"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="46"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Third</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">z</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">z</span></code>
<code id="47"></code>
<code id="48"><span style="color: rgb(63, 127, 95)">  /** Duplicate a term into a two-element tuple</span></code>
<code id="49"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="50"><span style="color: rgb(63, 127, 95)">   * @type a -&gt; Tuple(a, a)</span></code>
<code id="51"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="52"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Dupl</span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="53"></code>
<code id="54"><span style="color: rgb(63, 127, 95)">  /** Apply a pair of strategies, f and g, to an element.</span></code>
<code id="55"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="56"><span style="color: rgb(63, 127, 95)">   * @param f        a -&gt; a'</span></code>
<code id="57"><span style="color: rgb(63, 127, 95)">   * @param g        a -&gt; b'</span></code>
<code id="58"><span style="color: rgb(63, 127, 95)">   * @type           a -&gt; Tuple(a', b')</span></code>
<code id="59"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="60"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">f</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">g</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">f</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">g</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="61"><span style="color: rgb(63, 127, 95)">  </span></code>
<code id="62"><span style="color: rgb(63, 127, 95)">  /** Apply a triple of strategies, f, g and h to an element.</span></code>
<code id="63"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="64"><span style="color: rgb(63, 127, 95)">   * @param f        a -&gt; a'</span></code>
<code id="65"><span style="color: rgb(63, 127, 95)">   * @param g        a -&gt; b'</span></code>
<code id="66"><span style="color: rgb(63, 127, 95)">   * @param h        a -&gt; c'</span></code>
<code id="67"><span style="color: rgb(63, 127, 95)">   * @type           a -&gt; Tuple(a', b', c')</span></code>
<code id="68"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="69"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">split3</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">f</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">g</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">h</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">f</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">g</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">h</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="70"></code>
<code id="71"><span style="color: rgb(63, 127, 95)">  /** Swap two elements in a tuple.</span></code>
<code id="72"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="73"><span style="color: rgb(63, 127, 95)">   * @type Tuple(a, b) -&gt; Tuple(b, a)</span></code>
<code id="74"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="75"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Swap</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">y</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="76"></code>
<code id="77"><span style="color: rgb(63, 127, 95)">  /** Retrieve the head of a tuple. </span></code>
<code id="78"><span style="color: rgb(63, 127, 95)">   * </span></code>
<code id="79"><span style="color: rgb(63, 127, 95)">   * @type Tuple(a) -&gt; a</span></code>
<code id="80"><span style="color: rgb(63, 127, 95)">   * @see Fst</span></code>
<code id="81"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="82"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Thd</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">Fst</span></code>
<code id="83"><span style="color: rgb(63, 127, 95)">  </span></code>
<code id="84"><span style="color: rgb(63, 127, 95)">  /** Retrieve the tail of a tuple. A new tuple with all elements except</span></code>
<code id="85"><span style="color: rgb(63, 127, 95)">   * the first will be returned.</span></code>
<code id="86"><span style="color: rgb(63, 127, 95)">   * </span></code>
<code id="87"><span style="color: rgb(63, 127, 95)">   * @type Tuple(a) -&gt; Tuple(a)</span></code>
<code id="88"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="89"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">Ttl</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">:</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">xs</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="90"></code>
<code id="91"><span style="color: rgb(63, 127, 95)">  /** Get the nth element of a tuple. The index must be smaller than the</span></code>
<code id="92"><span style="color: rgb(63, 127, 95)">   * number of elements in the tuple.</span></code>
<code id="93"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="94"><span style="color: rgb(63, 127, 95)">   * @type (Int, Tuple(a)) -&gt; a</span></code>
<code id="95"><span style="color: rgb(63, 127, 95)">   * @see index</span></code>
<code id="96"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="97"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tindex</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="98"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">index</span></code>
<code id="99"></code>
<code id="100"><span style="color: rgb(63, 127, 95)">  /** Predicate that checks if the supplied term is a tuple.</span></code>
<code id="101"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="102"><span style="color: rgb(63, 127, 95)">   * @type Tuple(a) -?&gt; Tuple(a)</span></code>
<code id="103"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="104"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">is-tuple</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="105"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="106"></code>
<code id="107"><span style="color: rgb(63, 127, 95)">  /** Apply a strategy s to a swapped version of the supplied tuple.</span></code>
<code id="108"><span style="color: rgb(63, 127, 95)">   * The supplied tuple will be swapped, then is s applied.</span></code>
<code id="109"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="110"><span style="color: rgb(63, 127, 95)">   * @param s          Tuple(b,a) -&gt; Tuple(b', a')</span></code>
<code id="111"><span style="color: rgb(63, 127, 95)">   * @type             Tuple(a,b) -&gt; Tuple(b', a')</span></code>
<code id="112"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="113"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">flip</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">Swap</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span></code>
<code id="114"></code>
<code id="115"><span style="color: rgb(63, 127, 95)">  /** Apply a strategy to each element of a tuple. This strategy maps</span></code>
<code id="116"><span style="color: rgb(63, 127, 95)">   * a strategy s over all elements in a tuple.</span></code>
<code id="117"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="118"><span style="color: rgb(63, 127, 95)">   * @param s           a -&gt; b</span></code>
<code id="119"><span style="color: rgb(63, 127, 95)">   * @type              Tuple(a) -&gt; Tuple(b)</span></code>
<code id="120"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="121"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tmap</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="122"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-tuple</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">all</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="123"></code>
<code id="124"><span style="color: rgb(63, 127, 95)">  /** Concatenate the lists in a tuple of lists, using s as the</span></code>
<code id="125"><span style="color: rgb(63, 127, 95)">   * concatenation strategy.</span></code>
<code id="126"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="127"><span style="color: rgb(63, 127, 95)">   * The concatenation strategy is asked to concatenate a two-element</span></code>
<code id="128"><span style="color: rgb(63, 127, 95)">   * tuple of lists and produce a list. Concatenation goes from right to</span></code>
<code id="129"><span style="color: rgb(63, 127, 95)">   * left.</span></code>
<code id="130"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="131"><span style="color: rgb(63, 127, 95)">   * @param s          Tuple(List(a), List(a)) -&gt; List(a)</span></code>
<code id="132"><span style="color: rgb(63, 127, 95)">   * @type             Tuple(List(a))</span></code>
<code id="133"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="134"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tconcat</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="135"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-tuple</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">crush</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="136"></code>
<code id="137"><span style="color: rgb(63, 127, 95)">  /** Concatenate the lists in a tuple of lists, using s2 as the</span></code>
<code id="138"><span style="color: rgb(63, 127, 95)">   * concatenation strategy and s1 as the startup strategy.</span></code>
<code id="139"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="140"><span style="color: rgb(63, 127, 95)">   * The strategy s1 is applied once initially to an empty list, and</span></code>
<code id="141"><span style="color: rgb(63, 127, 95)">   * can be used to create a custom tail on the resulting list. It can</span></code>
<code id="142"><span style="color: rgb(63, 127, 95)">   * also be used to concatenate into non-list types.</span></code>
<code id="143"><span style="color: rgb(63, 127, 95)">   * </span></code>
<code id="144"><span style="color: rgb(63, 127, 95)">   * The concatenation strategy s2 is asked to concatenate a</span></code>
<code id="145"><span style="color: rgb(63, 127, 95)">   * two-element tuple of lists and produce list. Concatenation goes</span></code>
<code id="146"><span style="color: rgb(63, 127, 95)">   * from right to left.</span></code>
<code id="147"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="148"><span style="color: rgb(63, 127, 95)">   * Example: &lt;tconcat'(!0, \([a],b)-&gt;&lt;add&gt; (a,b)\)&gt; ([1],[2],[3]) =&gt; 6</span></code>
<code id="149"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="150"><span style="color: rgb(63, 127, 95)">   * @param s1         Nil -&gt; b</span></code>
<code id="151"><span style="color: rgb(63, 127, 95)">   * @param s2         Tuple(List(a), b) -&gt; b</span></code>
<code id="152"><span style="color: rgb(63, 127, 95)">   * @type             Tuple(List(a))</span></code>
<code id="153"><span style="color: rgb(63, 127, 95)">   * @see tconcat</span></code>
<code id="154"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="155"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tconcat'</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="156"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-tuple</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">crush</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="157"></code>
<code id="158"><span style="color: rgb(63, 127, 95)">  /** Apply a s1 and s2 in a catamorphic way to reduce a tuple.</span></code>
<code id="159"><span style="color: rgb(63, 127, 95)">   * </span></code>
<code id="160"><span style="color: rgb(63, 127, 95)">   * s2 must be a catamorphism, i.e. it must be able to reduce the </span></code>
<code id="161"><span style="color: rgb(63, 127, 95)">   * elements of the tuple from right to left.</span></code>
<code id="162"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="163"><span style="color: rgb(63, 127, 95)">   * This strategy is also named tfoldr, as it is equivalent to a </span></code>
<code id="164"><span style="color: rgb(63, 127, 95)">   * right-fold on tuples.</span></code>
<code id="165"><span style="color: rgb(63, 127, 95)">   * </span></code>
<code id="166"><span style="color: rgb(63, 127, 95)">   * @param s1         Nil -&gt; b</span></code>
<code id="167"><span style="color: rgb(63, 127, 95)">   * @param s2         Tuple(a, b) -&gt; b</span></code>
<code id="168"><span style="color: rgb(63, 127, 95)">   * @type             Tuple(a) -&gt; b</span></code>
<code id="169"><span style="color: rgb(63, 127, 95)">   * @see foldr</span></code>
<code id="170"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="171"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tcata</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="172"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">is-tuple</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">crush</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="173"></code>
<code id="174"><span style="color: rgb(63, 127, 95)">  /**</span></code>
<code id="175"><span style="color: rgb(63, 127, 95)">   * Fold a tuple from right to left using s2 as the folding strategy. </span></code>
<code id="176"><span style="color: rgb(63, 127, 95)">   * s1 is used to obtain the right-element (of type b) for s2. </span></code>
<code id="177"><span style="color: rgb(63, 127, 95)">   * </span></code>
<code id="178"><span style="color: rgb(63, 127, 95)">   * @param s1         Nil -&gt; b</span></code>
<code id="179"><span style="color: rgb(63, 127, 95)">   * @param s2         Tuple(a, b) -&gt; b</span></code>
<code id="180"><span style="color: rgb(63, 127, 95)">   * @type             Tuple(a) -&gt; b</span></code>
<code id="181"><span style="color: rgb(63, 127, 95)">   * @see tcata</span></code>
<code id="182"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="183"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tfoldr</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="184"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 64, 128)">tcata</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="185"></code>
<code id="186"><span style="color: rgb(63, 127, 95)">  /** Zip two tuples with s as the zipping strategy. </span></code>
<code id="187"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="188"><span style="color: rgb(63, 127, 95)">   * Example: &lt;tzip(add)&gt; ((1,2,3),(5,4,3)) -&gt; [6,6,6]</span></code>
<code id="189"><span style="color: rgb(63, 127, 95)">   *</span></code>
<code id="190"><span style="color: rgb(63, 127, 95)">   * @param s          Tuple(a,b) -&gt; c</span></code>
<code id="191"><span style="color: rgb(63, 127, 95)">   * @type             Tuple(Tuple(a), Tuple(b)) -&gt; c</span></code>
<code id="192"><span style="color: rgb(63, 127, 95)">   * @see zip</span></code>
<code id="193"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="194"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tzip</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)">  </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="195"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">TupleToList</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">TupleToList</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">zip</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="196"></code>
<code id="197"><span style="color: rgb(63, 127, 95)">  /**</span></code>
<code id="198"><span style="color: rgb(63, 127, 95)">   * @inc tuple-zip-test</span></code>
<code id="199"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="200"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tuple-zip</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="201"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">tmap</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Hd</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">tmap</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Tl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span></code>
<code id="202"><span style="color: rgb(63, 127, 95)">          </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">tmap</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="203"></code>
<code id="204"><span style="color: rgb(63, 127, 95)">  /**</span></code>
<code id="205"><span style="color: rgb(63, 127, 95)">   * @inc tuple-unzip-test</span></code>
<code id="206"><span style="color: rgb(63, 127, 95)">   */</span></code>
<code id="207"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">tuple-unzip</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span></code>
<code id="208"><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Thd</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">Ttl</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">map</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="209"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 255)">&quot;&quot;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">#</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span></code>