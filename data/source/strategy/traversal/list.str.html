<code id="0"><span style="color: rgb(63, 127, 95)">/**</span></code>
<code id="1"><span style="color: rgb(63, 127, 95)"> * This module defines a collection of generic one-pass traversals over</span></code>
<code id="2"><span style="color: rgb(63, 127, 95)"> * lists.</span></code>
<code id="3"><span style="color: rgb(63, 127, 95)"> *</span></code>
<code id="4"><span style="color: rgb(63, 127, 95)"> * The primitive term traversal operators of Strateg -- all, some, one --</span></code>
<code id="5"><span style="color: rgb(63, 127, 95)"> * can be combined with the other control operators in a wide variety</span></code>
<code id="6"><span style="color: rgb(63, 127, 95)"> * of ways to define full term traversals.</span></code>
<code id="7"><span style="color: rgb(63, 127, 95)"> *</span></code>
<code id="8"><span style="color: rgb(63, 127, 95)"> */</code>
<code id="9"></span><span style="color: rgb(127, 0, 85)">module</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">strategy/traversal/list</span></code>
<code id="10"><span style="color: rgb(127, 0, 85)">imports</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="11"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">strategy/conditional</span><span style="color: rgb(63, 127, 95)"> </code>
<code id="12"></span><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 0, 0)">strategy/traversal/simple</span></code>
<code id="13"><span style="color: rgb(127, 0, 85)">strategies</span></code>
<code id="14"><span style="color: rgb(63, 127, 95)">/*</span></code>
<code id="15"></code>
<code id="16"><span style="color: rgb(63, 127, 95)">	Term traversals can be categorized into classes according to</span></code>
<code id="17"><span style="color: rgb(63, 127, 95)">	how much of the term they traverse and to which parts</span></code>
<code id="18"><span style="color: rgb(63, 127, 95)">	of the term they modify.</span></code>
<code id="19"></code>
<code id="20"><span style="color: rgb(63, 127, 95)">	\paragraph{Everywhere}</span></code>
<code id="21"></code>
<code id="22"><span style="color: rgb(63, 127, 95)">	The most general class of traversals visits every node</span></code>
<code id="23"><span style="color: rgb(63, 127, 95)">	of a term and applies a transformation to it. The following</span></code>
<code id="24"><span style="color: rgb(63, 127, 95)">	operators define traversals that apply a strategy \verb|s|</span></code>
<code id="25"><span style="color: rgb(63, 127, 95)">	to all nodes of a term.</span></code>
<code id="26"></code>
<code id="27"><span style="color: rgb(63, 127, 95)">*/</span></code>
<code id="28"></code>
<code id="29"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 0, 128)">?</span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(0, 0, 0)">_</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">[</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">|</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">]</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(127, 0, 85)">all</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="30"></code>
<code id="31"></code>
<code id="32"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">topdown-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="33"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="34"></code>
<code id="35"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">bottomup-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="36"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="37"></code>
<code id="38"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">downup-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="39"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="40"></code>
<code id="41"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">downup-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="42"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="43"></code>
<code id="44"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">downup2-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="45"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="46"></code>
<code id="47"><span style="color: rgb(63, 127, 95)">/*</span></code>
<code id="48"><span style="color: rgb(63, 127, 95)">	</code>
<code id="49"></span><span style="color: rgb(63, 127, 95)">	The traversals above go through all constructors. If it</span></code>
<code id="50"><span style="color: rgb(63, 127, 95)">	is not necessary to traverse the entire tree, the following</span></code>
<code id="51"><span style="color: rgb(63, 127, 95)">	versions of the traversals can be used. They are parameterized</span></code>
<code id="52"><span style="color: rgb(63, 127, 95)">	with a strategy operator \verb|stop| that </span></code>
<code id="53"></code>
<code id="54"><span style="color: rgb(63, 127, 95)">*/</span></code>
<code id="55"></code>
<code id="56"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">topdownS-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">stop</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="57"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">stop</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="58"></code>
<code id="59"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">bottomupS-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">stop</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="60"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">stop</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="61"></code>
<code id="62"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">downupS-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">stop</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="63"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">stop</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="64"></code>
<code id="65"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">downupS-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">stop</span><span style="color: rgb(0, 0, 128)">:</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">*</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">-&gt;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">a</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="66"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">stop</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="67"></code>
<code id="68"><span style="color: rgb(63, 127, 95)">/*</span></code>
<code id="69"></code>
<code id="70"><span style="color: rgb(63, 127, 95)">	A variation on bottomup is a traversal that also provides the</span></code>
<code id="71"><span style="color: rgb(63, 127, 95)">	original term as well as the term in which the direct subterms</span></code>
<code id="72"><span style="color: rgb(63, 127, 95)">	have been transformed. (also known as a paramorphism?)</span></code>
<code id="73"></code>
<code id="74"><span style="color: rgb(63, 127, 95)">*/</span></code>
<code id="75"></code>
<code id="76"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">bottomup-para-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="77"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">!</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(127, 0, 85)">id</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;</span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">&gt;</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="78"></code>
<code id="79"><span style="color: rgb(63, 127, 95)">/*</span></code>
<code id="80"></code>
<code id="81"><span style="color: rgb(63, 127, 95)">	\paragraph{Frontier}</span></code>
<code id="82"></code>
<code id="83"><span style="color: rgb(63, 127, 95)">	Find all topmost applications of \verb|s|;</span></code>
<code id="84"></code>
<code id="85"><span style="color: rgb(63, 127, 95)">*/</span></code>
<code id="86"></code>
<code id="87"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">alltd-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="88"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="89"></code>
<code id="90"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">alldownup2-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="91"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="92"></code>
<code id="93"><span style="color: rgb(63, 127, 95)">  </span><span style="color: rgb(0, 64, 128)">alltd-fold-l</span><span style="color: rgb(0, 64, 128)">(</span><span style="color: rgb(0, 0, 0)">s1</span><span style="color: rgb(0, 0, 128)">,</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">s2</span><span style="color: rgb(0, 64, 128)">)</span><span style="color: rgb(0, 64, 128)"> </span><span style="color: rgb(0, 64, 128)">=</span><span style="color: rgb(0, 64, 128)"> </code>
<code id="94"></span><span style="color: rgb(0, 64, 128)">    </span><span style="color: rgb(127, 0, 85)">rec</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 0)">x</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">s1</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 0, 128)">&lt;+</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">all-l</span><span style="color: rgb(0, 0, 128)">(</span><span style="color: rgb(0, 64, 128)">x</span><span style="color: rgb(0, 0, 128)">)</span><span style="color: rgb(0, 0, 128)">;</span><span style="color: rgb(63, 127, 95)"> </span><span style="color: rgb(0, 64, 128)">s2</span><span style="color: rgb(0, 0, 128)">)</span></code>
<code id="95"></code>
<code id="96"><span style="color: rgb(63, 127, 95)">	</code>
<code id="97"></span></code>